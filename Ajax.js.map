{"version":3,"sources":["Ajax.es6"],"names":["METHODS","GET","POST","PUT","DELETE","Ajax","xhr","status","errored","aborted","timedOut","response","responseXML","responseText","method","url","extXhr","props","XMLHttpRequest","Object","defineProperty","value","enumerable","$","toString","get","getAsObject","setQueryParams","params","assertIsObject","set","getAsBoolean","setNoCache","onOff","getAsString","setId","id","assertIsString","setHeader","key","body","setBody","assert","isString","Document","Blob","BufferSource","FormData","URLSearchParams","ReadableStream","setJsonBody","jsonBody","setFormBody","formBody","onSuccess","setOnSuccess","callback","assertIsFunction","onError","setOnError","andFinally","setFinally","jsonResponse","JSON","parse","e","getAsInstanceOf","Error","error","addEventListener","onTimeOut","onAbort","onLoadEnd","succeeded","e1","e2","removeEventListener","bind","abort","headers","hasOwnProperty","setRequestHeader","toLowerCase","queryParams","noCache","Date","getTime","urlParams","encodeUrl","indexOf","open","send","stringify","forBody","toBoolean","replace","encodeURIComponent","obj","toObject","qry","sep","param","encodeUrlParam","isArray","i","length","create"],"mappings":"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","sourcesContent":["import { Tools as $ } from '@kinkajou/tools/Tools';\n\nconst METHODS = {\n\tGET: 'GET',\n\tPOST: 'POST',\n\tPUT: 'PUT',\n\tDELETE: 'DELETE',\n};\n\nexport class Ajax {\n\n\tget status() {\n\t\treturn this.xhr.status;\n\t}\n\n\tget succeeded() {\n\t\t\n\t\tif (this.errored || this.aborted || this.timedOut) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst status = this.status || 0;\n\n\t\t// Note: if we are using the file:// protocol, the status code will be 0\n\t\t// for all outcomes (successful or otherwise).\n\t\treturn status === 0 || (status >= 200 && status < 300);\n\t}\n\n\tget response() {\n\t\treturn this.xhr.response;\n\t}\n\n\tget xmlResponse() {\n\t\treturn this.xhr.responseXML;\n\t}\n\n\tget textResponse() {\n\t\treturn this.xhr.responseText;\n\t}\n\n\tconstructor(method, url, extXhr) {\n\n\t\tconst props = {};\n\t\tconst xhr = extXhr || new XMLHttpRequest();\n\n\t\tObject.defineProperty(this, 'xhr', {\n\t\t\tvalue: xhr,\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tObject.defineProperty(this, 'method', {\n\t\t\tvalue: METHODS[$.toString(method, METHODS.GET)] || METHODS.GET,\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tObject.defineProperty(this, 'url', {\n\t\t\tvalue: $.toString(url),\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tObject.defineProperty(this, 'queryParams', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsObject('queryParams', props, {});\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setQueryParams = params => {\n\t\t\t$.assertIsObject(params, 'queryParams');\n\t\t\t$.set('queryParams', params, props);\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'noCache', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsBoolean('noCache', props);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setNoCache = onOff => {\n\t\t\t$.set('noCache', onOff === true, props);\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'id', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsString('id', props);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setId = id => {\n\t\t\t$.assertIsString(id, 'id');\n\t\t\t$.set('id', id, props);\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'headers', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsObject('headers', props, {});\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setHeader = (key, value) => {\n\t\t\t$.assertIsString(key, 'key');\n\t\t\t$.assertIsString(value, 'value');\n\t\t\t$.set(['headers', key], value, props);\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'body', {\n\t\t\tget() {\n\t\t\t\treturn props.body;\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setBody = body => {\n\t\t\t$.assert(\n\t\t\t\t$.isString(body)\n\t\t\t\t\t|| (body instanceof Document)\n\t\t\t\t\t|| (body instanceof Blob)\n\t\t\t\t\t|| (body instanceof BufferSource)\n\t\t\t\t\t|| (body instanceof FormData)\n\t\t\t\t\t|| (body instanceof URLSearchParams)\n\t\t\t\t\t|| (body instanceof ReadableStream),\n\t\t\t\t'body can be a String, Document, Blob, BufferSource, FormData, URLSearchParams, ReadableStream'\n\t\t\t);\n\t\t\tprops.body = body;\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'jsonBody', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsObject('jsonBody', props);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setJsonBody = jsonBody => {\n\t\t\t$.assertIsObject(jsonBody, 'jsonBody');\n\t\t\tprops.jsonBody = jsonBody;\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'formBody', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsObject('formBody', props);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setFormBody = formBody => {\n\t\t\t$.assertIsObject(formBody, 'formBody');\n\t\t\tprops.formBody = formBody;\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'onSuccess', {\n\t\t\tget() {\n\t\t\t\treturn props.onSuccess;\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setOnSuccess = callback => {\n\t\t\t$.assertIsFunction(callback, 'callback');\n\t\t\tprops.onSuccess = callback;\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'onError', {\n\t\t\tget() {\n\t\t\t\treturn props.onError;\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setOnError = callback => {\n\t\t\t$.assertIsFunction(callback, 'callback');\n\t\t\tprops.onError = callback;\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'andFinally', {\n\t\t\tget() {\n\t\t\t\treturn props.andFinally;\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tthis.setFinally = callback => {\n\t\t\t$.assertIsFunction(callback, 'callback');\n\t\t\tprops.andFinally = callback;\n\t\t\treturn this;\n\t\t};\n\n\t\tObject.defineProperty(this, 'jsonResponse', {\n\t\t\tget() {\n\t\t\t\tif (!props.jsonResponse) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tprops.jsonResponse = JSON.parse(this.xhr.responseText);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tprops.jsonResponse = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn props.jsonResponse;\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tObject.defineProperty(this, 'errored', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsBoolean('errored', props);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tObject.defineProperty(this, 'error', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsInstanceOf('error', props, Error);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tObject.defineProperty(this, 'aborted', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsBoolean('aborted', props);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tObject.defineProperty(this, 'timedOut', {\n\t\t\tget() {\n\t\t\t\treturn $.getAsBoolean('timedOut', props);\n\t\t\t},\n\t\t\tenumerable: true,\n\t\t});\n\n\t\tconst onError = error => props.errored = true && (props.error = error);\n\t\txhr.addEventListener('error', onError, false);\n\n\t\tconst onTimeOut = () => props.timedOut = true;\n\t\txhr.addEventListener('timeout', onTimeOut, false);\n\n\t\tconst onAbort = () => props.aborted = true;\n\t\txhr.addEventListener('abort', onAbort, false);\n\n\t\tconst onLoadEnd = function() {\n\t\t\tlet callback;\n\t\t\ttry {\n\t\t\t\tif (this.succeeded) {\n\t\t\t\t\tcallback = this.onSuccess;\n\t\t\t\t\tif (callback) {\n\t\t\t\t\t\tcallback(this);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error(`${url} responded with status code ${xhr.status}`);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tprops.errored = true;\n\t\t\t\tprops.error = error;\n\t\t\t} finally {\n\t\t\t\ttry {\n\t\t\t\t\tif (props.errored) {\n\t\t\t\t\t\tcallback = this.onError;\n\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\tcallback(this);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (e1) {\n\t\t\t\t\t// ignored...\n\t\t\t\t} finally {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tcallback = this.andFinally;\n\t\t\t\t\t\tif (callback) {\n\t\t\t\t\t\t\tcallback(this);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (e2) {\n\t\t\t\t\t\txhr.removeEventListener('error', onError, false);\n\t\t\t\t\t\txhr.removeEventListener('timeout', onTimeOut, false);\n\t\t\t\t\t\txhr.removeEventListener('abort', onAbort, false);\n\t\t\t\t\t\txhr.removeEventListener('loadend', onLoadEnd, false);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}.bind(this);\n\t\txhr.addEventListener('loadend', onLoadEnd, false);\n\t}\n\n\tstatic encodeUrlParam(value, forBody) {\n\n\t\tvalue = $.toString(value);\n\n\t\t// Spec says to normalize newlines to \\r\\n and replace %20 spaces with +.\n\t\t// jQuery does this as well, so this is likely to be widely compatible.\n\t\tforBody = $.toBoolean(forBody);\n\n\t\tvalue = forBody ? value.replace(/\\r?\\n/g, '\\r\\n') : value;\n\t\tvalue = encodeURIComponent(value);\n\t\tvalue = forBody ? value.replace(/%20/g, '+') : value;\n\n\t\treturn value;\n\t}\n\n\tstatic encodeUrl(obj, forBody) {\n\n\t\tobj = $.toObject(obj, {});\n\n\t\tlet qry = '', sep = '';\n\n\t\tfor (const key in obj) {\n\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\tconst param = Ajax.encodeUrlParam(key, forBody);\n\t\t\t\tconst value = obj[key];\n\t\t\t\tif ($.isArray(value)) {\n\t\t\t\t\tfor (let i = 0; i < value.length; i++) {\n\t\t\t\t\t\tqry += sep + param + '=' + Ajax.encodeUrlParam(value[i], forBody);\n\t\t\t\t\t\tsep = '&';\n\t\t\t\t\t}\n\t\t\t\t} else if (value !== null) {\n\t\t\t\t\tqry += sep + param + '=' + Ajax.encodeUrlParam(value, forBody);\n\t\t\t\t\tsep = '&';\n\t\t\t\t} else {\n\t\t\t\t\tqry += sep + param;\n\t\t\t\t\tsep = '&';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn qry;\n\t}\n\n\tstatic create(method, url, xhr) {\n\t\treturn new Ajax(method, url, xhr);\n\t}\n\n\tstatic get(url) {\n\t\treturn Ajax.create(METHODS.GET, url);\n\t}\n\n\tstatic post(url) {\n\t\treturn Ajax.create(METHODS.POST, url);\n\t}\n\n\tstatic put(url) {\n\t\treturn Ajax.create(METHODS.PUT, url);\n\t}\n\n\tstatic delete(url) {\n\t\treturn Ajax.create(METHODS.PUT, url);\n\t}\n\n\tconfigure(callback) {\n\t\t$.assertIsFunction(callback, 'callback');\n\t\tcallback(this.xhr);\n\t}\n\n\tabort() {\n\t\tthis.xhr.abort();\n\t}\n\n\tsend() {\n\t\t\n\t\t/** @type {XMLHttpRequest} */ const xhr = this.xhr;\n\n\t\t// Headers\n\t\tconst headers = this.headers;\n\t\tfor (const key in headers) {\n\t\t\tif (headers.hasOwnProperty(key)) {\n\t\t\t\tconst value = headers[key];\n\t\t\t\txhr.setRequestHeader(key.toLowerCase(), value);\n\t\t\t}\n\t\t}\n\n\t\t// Method\n\t\tconst method = this.method;\n\n\t\t// URL\n\t\tlet url = this.url;\n\n\t\t// Query params\n\t\tconst queryParams = this.queryParams;\n\t\tif (this.noCache) {\n\t\t\tqueryParams['' + (new Date()).getTime()] = '';\n\t\t}\n\t\tconst urlParams = Ajax.encodeUrl(queryParams);\n\t\tif (urlParams) {\n\t\t\turl += url.indexOf('?') === -1 ? '?' : '&';\n\t\t\turl += urlParams;\n\t\t}\n\n\t\t// Open\n\t\txhr.open(method, url);\n\n\t\tconst jsonBody = this.jsonBody;\n\t\tconst formBody = this.formBody;\n\t\tconst body = this.body;\n\t\tif (jsonBody) {\n\t\t\txhr.send(JSON.stringify(jsonBody));\n\t\t} else if (formBody) {\n\t\t\txhr.send(Ajax.encodeUrl(formBody, true));\n\t\t} else {\n\t\t\txhr.send(body);\n\t\t}\n\n\t\treturn this;\n\t}\n\n}"],"file":"Ajax.js"}